<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
  /* Print page box */
  @page { size: A4; margin: 16mm; }

  /* Typography (document-wide) */
  html, body {
    font-family: Georgia, 'Times New Roman', Times, serif;
    font-size: 12px;
    line-height: 1.35;
    color: #000;
  }
  h1, h2 {
    margin: 0 0 10px 0;
    font-weight: 700; /* headings bold */
    font-family: Georgia, 'Times New Roman', Times, serif;
  }
  h1 { font-size: 18px; }
  h2 { font-size: 14px; }

  /* Layout containers */
  .container { max-width: 178mm; margin: 0 auto; } /* a hair narrower for safety */
  .header { text-align: left; margin-bottom: 14px; }
  .logo { max-height: 60px; width: auto; object-fit: contain; }

  /* Two-column info grid */
  .summary {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px 16px;
    margin-bottom: 14px;
  }

  /* Label/value pairs (stable, no overlap) */
  .kv {
    display: grid;
    grid-template-columns: 34mm 1fr; /* fixed label column */
    column-gap: 8px;
    row-gap: 6px;
  }
  .label { font-weight: 700; }      /* labels bold */
  .value {
    min-width: 0;
    font-weight: 400;               /* values normal */
    overflow-wrap: normal;          /* wrap only at spaces */
    word-break: normal;             /* no mid-word breaks */
    hyphens: none;                  /* avoid hyphenation breaks */
  }

  /* Table (tight, print-safe) */
  table{
    width: 99.2%;                   /* slack so borders/padding never overflow */
    border-collapse: collapse;
    table-layout: fixed;            /* fixed widths per colgroup */
    margin-top: 8px;
    box-sizing: border-box;
    font-size: 11.5px;              /* slightly tighter inside table only */
  }
  thead{
    background:#f4f4f4;
    display: table-header-group;    /* repeat header on page break */
  }
  th, td{
    border:1px solid #222;
    padding:5px 6px;                /* a bit tighter */
    text-align:left;
    vertical-align:top;
    box-sizing: border-box;
    overflow-wrap: normal;          /* wrap only at spaces */
    word-break: normal;             /* no mid-word breaks */
    hyphens: none;                  /* no auto hyphenation */
    font-weight:400;                /* cells normal by default */
    line-height: 1.3;               /* slightly tighter to fit multi-line names */
  }
  th{ font-weight:700; }            /* table headers bold */

  /* Stable column widths (rebalanced) */
  /* 1: Room Category, 2: Bed Type, 3: Breakfast, 4: Guest Name(s), 5: Adults, 6: Children */
  colgroup col:nth-child(1){ width: 23%; }
  colgroup col:nth-child(2){ width: 18%; }
  colgroup col:nth-child(3){ width: 11%; }
  colgroup col:nth-child(4){ width: 30%; }
  colgroup col:nth-child(5){ width: 8%;  }
  colgroup col:nth-child(6){ width: 10%;  }

  /* Keep short numeric columns on one line + centered */
  thead th:nth-child(5),
  thead th:nth-child(6),
  tbody td:nth-child(5),
  tbody td:nth-child(6){
    white-space: nowrap;            /* never break Adults/Children text or numbers */
    text-align: center;
  }

  /* Prevent awkward row splits */
  tr, th, td{ break-inside: avoid; }

  /* Sections */
  .section{ margin-top:14px; }
  .muted{ color:#555; }

  /* Lists (avoid blank bullets) */
  ul{ margin:8px 0 0 18px; padding:0; }
  li{ margin-bottom:4px; }

  /* Footer */
  .footer{
    margin-top:18px;
    font-size:11px;
    text-align:center;
    color:#555;
  }
</style>
</head>
<body>
<div class="container">
  <!-- Header with logo -->
  {% if logo_path %}
  <div class="header">
    <img src="{{ logo_path }}" alt="Company Logo" class="logo">
  </div>
  {% endif %}

  <!-- Two-column booking summary -->
  <div class="summary">
    <!-- Left column -->
    <div class="kv">
      <div class="label">Hotel:</div><div class="value">{{ hotel_name or '—' }}</div>
      <div class="label">Address:</div><div class="value">{{ hotel_address or '—' }}</div>
      <div class="label">Contact:</div><div class="value">{{ hotel_contact or '—' }}</div>
      <div class="label">Confirmation:</div><div class="value">{{ confirmation_number or 'TBC' }}</div>
      <div class="label">Location:</div><div class="value">
        {{ city or '—' }}{% if country %}, {{ country }}{% endif %}
      </div>
    </div>

    <!-- Right column -->
    <div class="kv">
      <div class="label">Lead Guest:</div><div class="value">{{ lead_guest_name or '—' }}</div>
      <div class="label">Nationality:</div><div class="value">{{ guest_nationality or '—' }}</div>
      <div class="label">Total Guests:</div><div class="value">{{ num_guests or '—' }}</div>
      <div class="label">Check-in:</div><div class="value">{{ check_in_date or '—' }}</div>
      <div class="label">Check-out:</div><div class="value">{{ check_out_date or '—' }}</div>
      <div class="label">Nights:</div><div class="value">{{ num_nights or '—' }}</div>
    </div>
  </div>

  <!-- Room table -->
  <div class="section">
    <h2>Room Details</h2>
    <table>
      <colgroup>
        <col><col><col><col><col><col>
      </colgroup>
      <thead>
        <tr>
          <th>Room Category</th>
          <th>Bed Type</th>
          <th>Breakfast</th>
          <th>Guest Name(s)</th>
          <th>Adults</th>
          <th>Children</th>
        </tr>
      </thead>
      <tbody>
        {% for room in rooms %}
        <tr>
          <td>{{ room.room_category or '—' }}</td>
          <td>{{ room.bed_type or 'Bed type assigned at check-in' }}</td>
          <td>{{ room.breakfast_included or 'Unknown' }}</td>
          <td>{{ (room.guest_names|join(', ')) if room.guest_names else '—' }}</td>
          <td>{{ room.adults if room.adults is not none else '—' }}</td>
          <td>{{ room.children if room.children is not none else '—' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Special Requests -->
  {% if special_requests %}
  <div class="section">
    <h2>Special Requests</h2>
    <p>{{ special_requests }}</p>
  </div>
  {% endif %}

  <!-- Additional Information (render only non-empty items) -->
  {% if additional_information and additional_information|length > 0 %}
  {% set clean_info = additional_information | select('string') | map('trim') | reject('equalto','') | list %}
  {% if clean_info|length > 0 %}
  <div class="section">
    <h2>Additional Information</h2>
    <ul>
      {% for item in clean_info %}
      <li>{{ item }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
  {% endif %}

  <!-- CR Holidays block -->
  <div class="section">
    <h2>CR Holidays Contact</h2>
    <div class="kv">
      <div class="label">Email:</div><div class="value">jay@crholidays.com</div>
      <div class="label">Phone:</div><div class="value">+91-8291604539</div>
      <div class="label">Address:</div><div class="value">
        705/706, 1st Floor, 'A' Block, Trade World E-Wing, Kamala City, Mumbai
      </div>
    </div>
  </div>

  <!-- Terms -->
  <div class="section">
    <h2>Terms &amp; Conditions</h2>
    <p class="muted">This voucher is valid only with confirmation. Please carry valid ID proof at check-in.</p>
  </div>

  <div class="footer">
    Generated by CR Holidays Voucher Standardizer
  </div>
</div>
</body>
</html>
